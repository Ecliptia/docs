---
title: PlayerManager
description: "Referência da API para a classe PlayerManager em Moonlink.js"
icon: 'lucide:music'
authors:
  - avatar: https://www.npmjs.com/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hNmE5NDVhYjJiNzk1MjcyNzVjN2IwMWEyNWM1YzQ2NT9zaXplPTQ5NiZkZWZhdWx0PXJldHJvIn0.5hP6oyShhR-UWUi6KF-lA0cWmE_BJjvIFAwkYCGEZNo
    name: Lucas Morais Rodrigues
    username: 1Lucas1apk
    to: https://github.com/1Lucas1apk
    target: _blank
---

<branch version="1.0.x">

::card{icon="lucide:music"}
#title
Classe PlayerManager

#description
A classe PlayerManager é responsável por gerenciar players de música no Moonlink.js. Ela fornece métodos para criar, recuperar e excluir players para diferentes servidores do Discord.
<br>
```js
manager.players
```
::

::alert{type="info" icon="lucide:info"}
O PlayerManager é acessado através da propriedade `players` da instância do Manager. Você não precisa criá-lo manualmente.
::

## Visão Geral

::card{icon="lucide:box"}
#title
Propriedades

#description
Propriedades principais da classe PlayerManager.
<br>
<h5>Propriedades Disponíveis</h5>

#content
| Propriedade | Tipo | Descrição |
|----------|------|-------------|
| `manager` | `Manager` | Referência à instância do Manager |
| `cache` | `Map<string, Player>` | Mapa contendo todos os players ativos |
::

## Métodos

::card{icon="lucide:settings"}
#title
Métodos

#description
Métodos disponíveis na classe PlayerManager.
<br>
<h5>Métodos Disponíveis</h5>

#content
#### create
::field{name="create" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:plus'
  ---
  #title
  Criar Player

  #description
  Cria um novo player para um servidor. Retorna um player existente se um já existir para o servidor.
  <br>
  <h5>Parâmetros</h5>

  ::field-group
    ::field{name="config" type="IPlayerConfig" required}
    Configuração para o player
    ::

    ::field{name="config.guildId" type="string" required}
    O ID do servidor
    ::

    ::field{name="config.voiceChannelId" type="string" required}
    O ID do canal de voz
    ::

    ::field{name="config.textChannelId" type="string" required}
    O ID do canal de texto
    ::

    ::field{name="config.volume" type="number"}
    Volume inicial (0-1000, padrão: 100)
    ::

    ::field{name="config.node" type="string"}
    Identificador do node a ser usado
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Retornos e Exemplo

  #description
  **Retornos**
  • **[`Player`](./Player.md) | `undefined`** — A instância do player criada ou `undefined` se nenhum node adequado for encontrado.

```js
// Criação básica de player
const player = manager.players.create({
  guildId: interaction.guildId,
  voiceChannelId: interaction.member.voice.channelId,
  textChannelId: interaction.channelId
});

// Player com configurações personalizadas
const player = manager.players.create({
  guildId: '123456789',
  voiceChannelId: '987654321',
  textChannelId: '456789123',
  volume: 80,
  node: 'main-node'
});
```
  ::
::
::

#### get
::field{name="get" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:search'
  ---
  #title
  Obter Player

  #description
  Obtém um player por ID do servidor.
  <br>
  <h5>Parâmetros</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    O ID do servidor
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Retornos e Exemplo

  #description
  **Retornos**
  • **[`Player`](./Player.md)** — A instância do player ou indefinido se não encontrado

```js
// Obter um player existente
const player = manager.players.get('123456789');
if (player) {
  console.log(`Volume atual: ${player.volume}`);
}
```
  ::
::
::

#### has
::field{name="has" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:check'
  ---
  #title
  Tem Player

  #description
  Verifica se um player existe para um servidor.
  <br>
  <h5>Parâmetros</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    O ID do servidor
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Retornos e Exemplo

  #description
  **Retornos**
  • **`boolean`** — Se o player existe

```js
// Verificar se um player existe
if (manager.players.has('123456789')) {
  console.log('Player existe para este servidor');
}
```
  ::
::
::

#### delete
::field{name="delete" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:trash'
  ---
  #title
  Excluir Player

  #description
  Exclui um player para um servidor.
  <br>
  <h5>Parâmetros</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    O ID do servidor
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Retornos e Exemplo

  #description
  **Retornos**
  • **`Promise<void>`** — Uma Promise que resolve quando o player é excluído com sucesso.

```js
// Excluir um player
await manager.players.delete('123456789');
console.log('Player excluído com sucesso');
```
  ::
::
::

#### all
::field{name="all" type="property"}
::stack
  ::card
  ---
  icon: 'lucide:list'
  ---
  #title
  Obter Todos os Players

  #description
  Obtém um array de todos os players ativos.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Retornos e Exemplo

  #description
  **Retornos**
  • **`Player[]`** — Array de todos os players ativos

```js
// Obter todos os players ativos
const players = manager.players.all;
console.log(`Total de players ativos: ${players.length}`);

// Listar todos os servidores em reprodução
players.forEach(player => {
  console.log(`Servidor ${player.guildId}: ${player.playing ? 'Tocando' : 'Ocioso'}`);
});
```
  ::
::
::

## Exemplos de Uso

::card{icon="lucide:code"}
#title
Exemplos Básicos

#description
Exemplos simples de uso do PlayerManager.

#content
### Criando e Gerenciando um Player

```js
// Criação e gerenciamento básico de player
client.on('interactionCreate', async (interaction) => {
  if (!interaction.isCommand()) return;

  if (interaction.commandName === 'play') {
    // Verifique se o usuário está em um canal de voz
    if (!interaction.member.voice.channelId) {
      return interaction.reply('Você precisa estar em um canal de voz!');
    }

    // Crie ou obtenha um player existente
    const player = manager.players.create({
      guildId: interaction.guildId,
      voiceChannelId: interaction.member.voice.channelId,
      textChannelId: interaction.channelId
    });

    // Pesquise por uma faixa
    const query = interaction.options.getString('song');
    const result = await manager.search(query);

    if (!result?.tracks?.length) {
      return interaction.reply('Nenhum resultado encontrado!');
    }

    // Adicione a faixa à fila
    player.queue.add(result.tracks[0]);
    
    if (!player.playing) {
      player.play();
    }

    interaction.reply(`Adicionado ${result.tracks[0].title} à fila!`);
  }

  if (interaction.commandName === 'stop') {
    // Verifique se o player existe
    if (!manager.players.has(interaction.guildId)) {
      return interaction.reply('Nenhuma música está tocando!');
    }

    // Exclua o player
    await manager.players.delete(interaction.guildId);
    interaction.reply('Música parada e canal abandonado!');
  }
});
```

### Monitoramento do Status do Player

```js
// Comando para verificar o status do player
client.on('interactionCreate', async (interaction) => {
  if (!interaction.isCommand()) return;

  if (interaction.commandName === 'status') {
    const players = manager.players.all;
    
    if (players.length === 0) {
      return interaction.reply('Nenhum player ativo');
    }

    const status = players.map(player => ({
      guild: player.guildId,
      playing: player.playing,
      track: player.current?.title || 'Nenhum',
      volume: player.volume
    }));

    const embed = {
      title: 'Status do Player',
      fields: status.map(s => ({
        name: `Servidor: ${s.guild}`,
        value: `Tocando: ${s.playing ? 'Sim' : 'Não'}\nFaixa: ${s.track}\nVolume: ${s.volume}%`
      })),
      color: 0x3498db
    };

    interaction.reply({ embeds: [embed] });
  }
});
```

### Tratamento Básico de Erros

```js
// Exemplo de tratamento de erros do player
client.on('interactionCreate', async (interaction) => {
  if (!interaction.isCommand()) return;

  if (interaction.commandName === 'play') {
    try {
      const player = manager.players.create({
        guildId: interaction.guildId,
        voiceChannelId: interaction.member.voice.channelId,
        textChannelId: interaction.channelId
      });

      // Sua lógica de reprodução aqui
    } catch (error) {
      console.error('Erro ao criar player:', error);
      interaction.reply('Falha ao criar player. Por favor, tente novamente.');
    }
  }
});

// Lidar com erros de conexão do player
manager.on('playerError', (player, error) => {
  const channel = client.channels.cache.get(player.textChannelId);
  if (channel) {
    channel.send('Ocorreu um erro com o player. Limpando...');
  }
  manager.players.delete(player.guildId);
});
```
::

## Gerenciador de Player

::button-link{right-icon="lucide:arrow-right" to="/api/node-manager"}
  Continuar para NodeManager
:: 
