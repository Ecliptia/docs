---
title: Manager
description: "API reference for the Manager class in Moonlink.js"
icon: 'lucide:settings'
authors:
  - avatar: https://www.npmjs.com/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hNmE5NDVhYjJiNzk1MjcyNzVjN2IwMWEyNWM1YzQ2NT9zaXplPTQ5NiZkZWZhdWx0PXJldHJvIn0.5hP6oyShhR-UWUi6KF-lA0cWmE_BJjvIFAwkYCGEZNo
    name: Lucas Morais Rodrigues
    username: 1Lucas1apk
    to: https://github.com/1Lucas1apk
    target: _blank
---

::card{icon="lucide:settings"}
#title
Manager Class

#description
The `Manager` class is the main entry point for Moonlink.js. It manages connections to Lavalink nodes, creates and manages players, and handles events. The Manager class extends EventEmitter to provide a robust event system.

See also:
- [Player](/api/player) - For player management
- [NodeManager](/api/node-manager) - For node management
- [PlayerManager](/api/player-manager) - For player collection management
::

::alert{type="info" icon="lucide:info"}
The Manager must be initialized after your Discord client is ready using the `init` method.
::

## Configuration

::card{icon="lucide:wrench"}
#title
Configuration Options

#description
When creating a manager, you can specify several options:
<br>

```typescript
interface IConfigManager {
  nodes: INode[];
  sendPayload: (guildId: string, payload: any) => void;
  options: IOptionsManager;
}

interface INode {
  host: string;
  port: number;
  password: string;
  secure?: boolean;
  identifier?: string;
  retryAmount?: number;
  retryDelay?: number;
  regions?: string[];
  sessionId?: string;
  pathVersion?: string;
}

interface IOptionsManager {
  clientName?: string;
  clientId?: string;
  defaultPlatformSearch?: string;
  sortTypeNode?: TSortTypeNode;
  plugins?: Plugin[];
  noReplace?: boolean;
  NodeLinkFeatures?: boolean;
  logFile?: { path: string; log: boolean };
  movePlayersOnReconnect?: boolean;
  sortPlayersByRegion?: boolean;
  autoResume?: boolean;
  resume?: boolean;
  partialTrack?: TPartialTrackProperties[];
  disableDatabase?: boolean;
  disableNativeSources?: boolean;
  blacklisteSources?: string[];
  spotify?: {
    limitLoadPlaylist?: number;
    limitLoadAlbum?: number;
    limitLoadArtist?: number;
    limitLoadSearch?: number;
    limitLoadRecommendations?: number;
  };
  deezer?: {
    maxSearchResults?: number;
    maxAlbumTracks?: number;
    maxPlaylistTracks?: number;
    maxArtistTracks?: number;
  };
}
```

#example
```js
const manager = new Manager({
  nodes: [{
    host: 'localhost',
    port: 2333,
    password: 'youshallnotpass',
    secure: false,
    retryAmount: 5,
    retryDelay: 3000
  }],
  sendPayload: (guildId, payload) => {
    const guild = client.guilds.cache.get(guildId);
    if (guild) guild.shard.send(payload);
  },
  options: {
    defaultPlatformSearch: 'youtube',
    sortPlayersByRegion: true,
    autoResume: true
  }
});
```
::

## Properties

::card{icon="lucide:database"}
#title
Available Properties

#description
<br>

| Property | Type | Description | Default |
|----------|------|-------------|---------|
| `initialize` | `boolean` | Whether the manager has been initialized | `false` |
| `options` | `IOptionsManager` | Manager configuration options | Created |
| `sendPayload` | `Function` | Function for sending voice state updates | Required |
| `nodes` | `NodeManager` | Node manager instance | Created |
| `players` | `PlayerManager` | Player manager instance | Created |
| `version` | `string` | Current version of Moonlink.js | Package version |
| `database` | `Database` | Database instance | Created |
| `sources` | `SourceManager` | Source manager instance | Created |
| `pluginManager` | `PluginManager` | Plugin manager instance | Created |

::

## Methods

#### init
::field{name="init" type="method"}
::stack
  ::card{icon="lucide:power"}
  #title
  Initialize Manager
  
  #description
  Initializes the manager and connects to all configured nodes. This method sets up the database, initializes nodes, and prepares the manager for handling voice connections.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="clientId" type="string" required}
      The Discord client ID
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`**

  ```js
  client.once('ready', () => {
    manager.init(client.user.id);
  });
  ```
  ::
::
::

#### search
::field{name="search" type="method"}
::stack
  ::card{icon="lucide:search"}
  #title
  Search Tracks
  
  #description
  Searches for tracks using the configured nodes or native sources (like Spotify). The search will be performed on the best available node or a specific node if provided. Supports fallback sources.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="options" type="Object" required}
      Search options
    ::

    ::field{name="options.query" type="string" required}
    Search query
    ::

    ::field{name="options.source" type="string"}
    Platform to search on (youtube, soundcloud, etc.)
    ::

    ::field{name="options.node" type="string"}
    Specific node to use
    ::

    ::field{name="options.requester" type="unknown"}
    Track requester info
    ::

    ::field{name="options.fallbackSources" type="TSearchSources[]"}
    Optional: An array of fallback sources to try if the initial search fails.
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<SearchResult>`** — Search results containing tracks and playlist info

  ```js
  const results = await manager.search({
    query: 'Never Gonna Give You Up',
    source: 'youtube',
    fallbackSources: ['soundcloud', 'deezer']
  });
  ```
  ::
::
::

#### lavaSearch
::field{name="lavaSearch" type="method"}
::stack
  ::card{icon="lucide:search"}
  #title
  LavaSearch Tracks
  
  #description
  Performs a search using the LavaSearch plugin, supporting multiple result types (tracks, albums, artists, playlists, text). Requires a NodeLink server with LavaSearch plugin.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="options" type="Object" required}
      LavaSearch options
    ::

    ::field{name="options.query" type="string" required}
    Search query
    ::

    ::field{name="options.source" type="string"}
    Platform to search on (youtube, soundcloud, etc.)
    ::

    ::field{name="options.node" type="string"}
    Specific node to use
    ::

    ::field{name="options.requester" type="unknown"}
    Track requester info
    ::

    ::field{name="options.types" type="string"}
    Comma-separated string of result types to return (e.g., "track,album,artist"). Defaults to "track,album,artist,playlist,text".
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<SearchResult>`** — Search results containing various types of data.

  ```js
  const results = await manager.lavaSearch({
    query: 'Never Gonna Give You Up',
    source: 'youtube',
    types: 'track,artist'
  });

  if (results.tracks.length > 0) {
    console.log('Found tracks:', results.tracks.map(t => t.title));
  }
  if (results.artists && results.artists.length > 0) {
    console.log('Found artists:', results.artists.map(a => a.info.name));
  }
  ```
  ::
::
::

#### getLyrics
::field{name="getLyrics" type="method"}
::stack
  ::card{icon="lucide:file-text"}
  #title
  Get Lyrics
  
  #description
  Fetches lyrics for a track using available lyrics plugins. Supports fetching by player's current track, encoded track, or video ID. Prioritizes timed lyrics.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="options" type="Object" required}
      Lyrics options
    ::

    ::field{name="options.player" type="Player"}
    The player instance to get lyrics for its current track.
    ::

    ::field{name="options.encodedTrack" type="string"}
    Base64 encoded track string.
    ::

    ::field{name="options.videoId" type="string"}
    YouTube video ID.
    ::

    ::field{name="options.skipTrackSource" type="boolean"}
    Whether to skip the track's original source when searching for lyrics.
    ::

    ::field{name="options.provider" type="'lavalyrics' | 'lyrics' | 'java-lyrics-plugin'"}
    Specific lyrics provider to use.
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<ILavaLyricsObject | null>`** — Lyrics data or `null` if not found.

  ```js
  // Get lyrics for current playing track
  const lyrics = await manager.getLyrics({ player: myPlayer });
  if (lyrics) {
    console.log(`Lyrics for ${lyrics.track.title}:
${lyrics.text}`);
  }

  // Get lyrics by video ID
  const youtubeLyrics = await manager.getLyrics({ videoId: 'dQw4w9WgXcQ' });
  ```
  ::
::
::

#### searchLyrics
::field{name="searchLyrics" type="method"}
::stack
  ::card{icon="lucide:search"}
  #title
  Search Lyrics
  
  #description
  Searches for lyrics based on a query using available lyrics plugins.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="options" type="Object" required}
      Search options
    ::

    ::field{name="options.query" type="string" required}
    The search query (e.g., song title and artist).
    ::

    ::field{name="options.provider" type="'lavalyrics' | 'lyrics' | 'java-lyrics-plugin'"}
    Specific lyrics provider to use.
    ::

    ::field{name="options.node" type="string"}
    Specific node to use for the search.
    ::

    ::field{name="options.source" type="string"}
    Optional source to narrow down the search (e.g., "youtube").
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<any[] | null>`** — An array of search results or `null` if no results found.

  ```js
  const searchResults = await manager.searchLyrics({ query: 'Never Gonna Give You Up Rick Astley' });
  if (searchResults && searchResults.length > 0) {
    console.log('Found lyrics search results:', searchResults);
  }
  ```
  ::
::
::

#### subscribeLyrics
::field{name="subscribeLyrics" type="method"}
::stack
  ::card{icon="lucide:message-square"}
  #title
  Subscribe to Live Lyrics
  
  #description
  Subscribes to live lyrics updates for a specific guild. The provided callback will be invoked with each new lyrics line.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    The ID of the guild.
    ::

    ::field{name="callback" type="(line: ILavaLyricsLine) => void" required}
    The callback function to receive lyrics line updates.
    ::

    ::field{name="skipTrackSource" type="boolean"}
    Whether to skip the track's original source when searching for lyrics.
    ::

    ::field{name="provider" type="'lavalyrics' | 'lyrics' | 'java-lyrics-plugin'"}
    Specific lyrics provider to use.
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<void>`**

  ```js
  manager.subscribeLyrics('123456789', (line) => {
    console.log(`Live Lyric: ${line.line} (at ${line.timestamp}ms)`);
  });
  ```
  ::
::
::

#### unsubscribeLyrics
::field{name="unsubscribeLyrics" type="method"}
::stack
  ::card{icon="lucide:message-square-off"}
  #title
  Unsubscribe from Live Lyrics
  
  #description
  Unsubscribes from live lyrics updates for a specific guild.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    The ID of the guild.
    ::

    ::field{name="provider" type="'lavalyrics' | 'lyrics' | 'java-lyrics-plugin'"}
    Specific lyrics provider to unsubscribe from.
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<void>`**

  ```js
  manager.unsubscribeLyrics('123456789');
  console.log('Unsubscribed from live lyrics.');
  ```
  ::
::
::

#### createPlayer
::field{name="createPlayer" type="method"}
::stack
  ::card{icon="lucide:plus"}
  #title
  Create Player
  
  #description
  ::alert{type="warning" icon="lucide:alert-triangle"}
  This method is deprecated. Use `manager.players.create()` instead.
  ::
  Creates a new player instance for a guild. The player will be automatically managed by the PlayerManager.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="config" type="IPlayerConfig" required}
    Player configuration. See [Player Configuration](/api/player#configuration)
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Player`** — The created player instance

  ```js
  const player = manager.createPlayer({
    guildId: '123456789',
    voiceChannelId: '123456789',
    textChannelId: '123456789'
  });
  ```
  ::
::
::

#### getPlayer
::field{name="getPlayer" type="method"}
::stack
  ::card{icon="lucide:box"}
  #title
  Get Player

  #description
  ::alert{type="warning" icon="lucide:alert-triangle"}
  This method is deprecated. Use `manager.players.get()` instead.
  ::
  Gets an existing player instance for a guild.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    Guild ID
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Player`** — The player instance if it exists

  ```js
  const player = manager.getPlayer('123456789');
  ```
  ::
::
::

#### hasPlayer
::field{name="hasPlayer" type="method"}
::stack
  ::card{icon="lucide:check"}
  #title
  Has Player

  #description
  ::alert{type="warning" icon="lucide:alert-triangle"}
  This method is deprecated. Use `manager.players.has()` instead.
  ::
  Checks if a player exists for a guild.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    Guild ID
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`boolean`** — Whether the player exists

  ```js
  const exists = manager.hasPlayer('123456789');
  ```
  ::
::
::

#### deletePlayer
::field{name="deletePlayer" type="method"}
::stack
  ::card{icon="lucide:trash"}
  #title
  Delete Player

  #description
  ::alert{type="warning" icon="lucide:alert-triangle"}
  This method is deprecated. Use `manager.players.delete()` instead.
  ::
  Deletes a player instance and cleans up its resources.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="guildId" type="string" required}
    Guild ID
    ::
  ::
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`boolean`** — Whether the deletion was successful

  ```js
  manager.deletePlayer('123456789');
  ```
  ::
::
::

#### getAllPlayers
::field{name="getAllPlayers" type="method"}
::stack
  ::card{icon="lucide:list"}
  #title
  Get All Players

  #description
  ::alert{type="warning" icon="lucide:alert-triangle"}
  This method is deprecated. Use `manager.players.all` instead.
  ::
  Gets all active player instances from the cache.
  <br>
  ::

  ::card
  #title
  Returns & Example

  #description
  **Returns**
  • **`Map<string, Player>`** — Map of all players

  ```js
  const players = manager.getAllPlayers();
  ```
  ::
::
::

## Events

::card{icon="lucide:radio"}
  #title
Available Events

  #description
The Manager class extends EventEmitter and provides these event categories:

### General Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `autoLeaved` | Emitted when a player automatically leaves a voice channel. | `player: Player, track: Track` |
| `debug` | Emitted when debug information is available. | `...args: any` |

### Node Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `nodeRaw` | Emitted when a raw WebSocket message is received from a node. | `node: INode, payload: any` |
| `nodeCreate` | Emitted when a new node is created. | `node: INode` |
| `nodeReady` | Emitted when a node is ready and connected. | `node: INode, stats: INodeStats` |
| `nodeConnected` | Emitted when a node successfully connects. | `node: INode` |
| `nodeError` | Emitted when a node encounters an error. | `node: INode, error: Error` |
| `nodeReconnect` | Emitted when a node attempts to reconnect. | `node: INode` |
| `nodeDisconnect` | Emitted when a node disconnects. | `node: INode, code: number, reason: string` |
| `nodeDestroy` | Emitted when a node is destroyed. | `identifier: string` |
| `nodeAutoResumed` | Emitted when players are auto-resumed on a node. | `node: INode, players: Player[]` |
| `nodeStateChange` | Emitted when a node's state changes. | `node: Node, oldState: NodeState, newState: NodeState` |

### Player Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `playerCreate` | Emitted when a new player is created. | `player: Player` |
| `playerUpdate` | Emitted when player state updates. | `player: Player, track: Track, payload: any` |
| `playerDestroy` | Emitted when a player is destroyed. | `player: Player` |
| `playerSwitchedNode` | Emitted when a player switches to a different node. | `player: Player, oldNode: Node, newNode: Node` |
| `playerConnecting` | Emitted when a player attempts to connect to a voice channel. | `player: Player` |
| `playerReady` | Emitted when a player is ready to play. | `player: Player` |
| `playerResuming` | Emitted when a player is attempting to resume playback. | `player: Player` |
| `playerResumed` | Emitted when a player successfully resumes playback. | `player: Player` |
| `playerConnected` | Emitted when a player connects to a voice channel. | `player: Player` |
| `playerDisconnected` | Emitted when a player disconnects from a voice channel. | `player: Player` |
| `playerReconnect` | Emitted when a player attempts to reconnect. | `player: Player, reason?: string` |
| `playerMoved` | Emitted when a player moves voice channels. | `player: Player, oldChannel: string, newChannel: string` |
| `playerDestroyed` | Emitted when a player is destroyed. | `player: Player, reason?: string` |
| `playerTriggeredBack` | Emitted when a player goes back to the previous track. | `player: Player, track: Track` |
| `playerChapterSkipped` | Emitted when a player skips to a new chapter. | `player: Player, chapter: IChapter` |

### Track Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `trackStart` | Emitted when a track starts playing. | `player: Player, track: Track` |
| `trackEnd` | Emitted when a track ends. | `player: Player, track: Track, type: TTrackEndType, payload?: any` |
| `trackStuck` | Emitted when a track gets stuck. | `player: Player, track: Track, threshold: number` |
| `trackException` | Emitted when a track encounters an exception. | `player: Player, track: Track, exception: any` |
| `queueEnd` | Emitted when the queue ends. | `player: Player, track?: any` |
| `trackBlacklisted` | Emitted when a track from a blacklisted source is encountered. | `player: Player, track: Track` |

### Player State Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `playerTriggeredPlay` | Emitted when a player starts playing. | `player: Player, track: Track` |
| `playerTriggeredPause` | Emitted when playback is paused. | `player: Player` |
| `playerTriggeredResume` | Emitted when playback is resumed. | `player: Player` |
| `playerTriggeredStop` | Emitted when playback is stopped. | `player: Player` |
| `playerTriggeredSkip` | Emitted when a track is skipped. | `player: Player, oldTrack: Record<string, any>, currentTrack: Track, postion: number` |
| `playerTriggeredSeek` | Emitted when a track is seeked. | `player: Player, position: number` |
| `playerTriggeredShuffle` | Emitted when the queue is shuffled. | `player: Player, oldQueue: Record<string, any>, currentQueue: Track[]` |
| `playerSpeak` | Emitted when the player speaks using TTS. | `player: Player, text: string, options?: ISpeakOptions` |

### Settings Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `playerChangedVolume` | Emitted when the player's volume changes. | `player: Player, oldVolume: number, newVolume: number` |
| `playerChangedLoop` | Emitted when the player's loop mode changes. | `player: Player, oldLoop: TPlayerLoop, newLoop: TPlayerLoop, oldLoopCount?: number, newLoopCount?: number` |
| `playerAutoPlaySet` | Emitted when the player's auto-play setting changes. | `player: Player, autoPlay: boolean` |
| `playerAutoLeaveSet` | Emitted when the player's auto-leave setting changes. | `player: Player, autoLeave: boolean` |
| `playerTextChannelIdSet` | Emitted when the player's text channel ID changes. | `player: Player, oldChannel: string, newChannel: string` |
| `playerVoiceChannelIdSet` | Emitted when the player's voice channel ID changes. | `player: Player, oldChannel: string, newChannel: string` |
| `playerNodeSet` | Emitted when the player's node changes. | `player: Player, oldNode: string, newNode: string` |

### Queue Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `queueAdd` | Emitted when tracks are added to the queue. | `player: Player, tracks: Track | Track[]` |
| `queueRemove` | Emitted when tracks are removed from the queue. | `player: Player, tracks: Track | Track[]` |
| `queueMoveRange` | Emitted when a range of tracks is moved within the queue. | `player: Player, tracks: Track[], fromIndex: number, toIndex: number` |
| `queueRemoveRange` | Emitted when a range of tracks is removed from the queue. | `player: Player, tracks: Track[], startIndex: number, endIndex: number` |
| `queueDuplicate` | Emitted when tracks are duplicated in the queue. | `player: Player, tracks: Track[], index: number` |

### Filter Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `filtersUpdate` | Emitted when audio filters are updated. | `player: Player, filters: Filters` |

### Source Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `sourceAdd` | Emitted when a source is added. | `source: ISource` |
| `sourceRemove` | Emitted when a source is removed. | `source: string` |
| `sourceClear` | Emitted when all sources are cleared. | `void` |

### SponsorBlock Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `segmentsLoaded` | Emitted when SponsorBlock segments are loaded for a track. | `player: Player, segments: ISegment[]` |
| `segmentSkipped` | Emitted when a SponsorBlock segment is skipped. | `player: Player, segment: ISegment` |

### Chapter Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `chaptersLoaded` | Emitted when chapters are loaded for a track. | `player: Player, chapters: IChapter[]` |
| `chapterStarted` | Emitted when a new chapter starts playing. | `player: Player, chapter: IChapter` |

### WebSocket Events
| Event | Description | Parameters |
|-------|-------------|------------|
| `socketClosed` | Emitted when the WebSocket connection is closed. | `player: Player, code: number, reason: string, byRemote: boolean` |

Example:
    ```js
    manager.on('trackStart', (player, track) => {
      console.log(`Now playing: ${track.title}`);
    });

manager.on('nodeError', (node, error) => {
  console.error(`Node ${node.identifier} had an error:`, error);
});
```
  ::
