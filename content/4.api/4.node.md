---
title: Node
description: "API reference for the Node class in Moonlink.js"
icon: 'lucide:server'
authors:
  - avatar: https://www.npmjs.com/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hNmE5NDVhYjJiNzk1MjcyNzVjN2IwMWEyNWM1YzQ2NT9zaXplPTQ5NiZkZWZhdWx0PXJldHJvIn0.5hP6oyShhR-UWUi6KF-lA0cWmE_BJjvIFAwkYCGEZNo
    name: Lucas Morais Rodrigues
    username: 1Lucas1apk
    to: https://github.com/1Lucas1apk
    target: _blank
---

The `Node` class represents a connection to a Lavalink server. It manages the communication between your Discord bot and the Lavalink server, enabling audio playback.

::alert{type="info" icon="lucide:info"}
Nodes are the connection points to Lavalink servers. Each node handles the actual audio processing and streaming, while your bot manages the player interface.
::

::card
---
icon: lucide:box
---

#title
Constructor

#description
The Node constructor is not meant to be used directly

#content
Nodes are automatically created by the `Manager` when you initialize it with node options.

```js
// Don't use directly
// new Node(options, manager);

// Instead, configure nodes through the Manager
const manager = new Manager({
  nodes: [
    {
      identifier: 'Node 1',
      host: 'localhost',
      port: 2333,
      password: 'youshallnotpass',
      secure: false
    }
  ],
  // ... other options
});
```

#footer
Always configure nodes through the Manager
::

## Properties

| Property | Type | Description | Default |
|----------|------|-------------|---------|
| `uuid` | `String` | Unique identifier for the node instance | Generated |
| `host` | `String` | The hostname of the Lavalink server | Required |
| `port` | `Number` | The port of the Lavalink server | Required |
| `identifier` | `String` | A unique identifier for the node. If not provided, a UUID will be generated. | Generated |
| `password` | `String` | The password for the Lavalink server. | `"youshallnotpass"` |
| `pathVersion` | `String` | API version path for Lavalink | `"v4"` |
| `connected` | `Boolean` | Whether the node is connected | `false` |
| `destroyed` | `Boolean` | Whether the node has been destroyed | `false` |
| `reconnectTimeout` | `NodeJS.Timeout` | Current reconnection timeout | `undefined` |
| `reconnectAttempts` | `Number` | Number of reconnection attempts made | `0` |
| `retryAmount` | `Number` | Maximum number of reconnection attempts | `5` |
| `retryDelay` | `Number` | Delay between reconnection attempts (ms) | `60000` |
| `resumed` | `Boolean` | Whether the node session was resumed | `false` |
| `resumeTimeout` | `Number` | Session resume timeout (ms) | `60000` |
| `regions` | `Array<String>` | Voice regions associated with this node | `[]` |
| `secure` | `Boolean` | Whether to use SSL/TLS connection | `false` |
| `sessionId` | `String` | The current session ID | Generated |
| `priority` | `Number` | The priority of the node for selection | `undefined` |
| `socket` | `WebSocket` | The WebSocket connection to Lavalink | Created |
| `stats` | `INodeStats` | Node statistics (CPU, memory, players) | `undefined` |
| `info` | `Object` | Additional node information | `undefined` |
| `version` | `String` | Lavalink server version | `undefined` |
| `url` | `String` | Base URL for REST requests | Generated |
| `rest` | `REST` | The REST instance for making HTTP requests | Created |
| `state` | `NodeState` | The current state of the node | `DISCONNECTED` |
| `capabilities` | `Array<String>` | Capabilities supported by the node (e.g., `lavadspx`, `lavasearch`) | `[]` |
| `plugins` | `Map<String, AbstractPlugin>` | Map of loaded plugins for this node | `Map` |

## Methods

#### connect
::field{name="connect" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:link'
  ---
  #title
  Connect to Node

  #description
  Establishes connection to the Lavalink server with optional session resuming. Sets the node state to `CONNECTING`.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`**

  ```js
  node.connect();
  ```
  ::
::
::

#### reconnect
::field{name="reconnect" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:refresh-cw'
  ---
  #title
  Reconnect Node

  #description
  Attempts to reconnect to the Lavalink server after a delay with exponential backoff. Sets the node state to `CONNECTING`. If reconnect attempts are exhausted, it attempts to migrate players to another node.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`**

  ```js
  node.reconnect();
  ```
  ::
::
::

#### destroy
::field{name="destroy" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:trash'
  ---
  #title
  Destroy Node

  #description
  Closes the WebSocket connection and marks the node as destroyed. Unloads any loaded plugins for this node.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`**

  ```js
  node.destroy();
  ```
  ::
::
::

#### getPlayers
::field{name="getPlayers" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:users'
  ---
  #title
  Get Players

  #description
  Gets all players connected to this node.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`Player[]`** — Array of players connected to this node

  ```js
  const players = node.getPlayers();
  console.log(`Players on node: ${players.length}`);
  ```
  ::
::
::

#### getPlayersCount
::field{name="getPlayersCount" type="property"}
::stack
  ::card
  ---
  icon: 'lucide:users'
  ---
  #title
  Get Players Count

  #description
  Gets the number of players connected to this node.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`number`** — Number of connected players

  ```js
  const count = node.getPlayersCount;
  console.log(`Connected players: ${count}`);
  ```
  ::
::
::

#### getSystemStats
::field{name="getSystemStats" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:activity'
  ---
  #title
  Get System Stats

  #description
  Retrieves CPU and memory usage statistics for the node.
  <br>
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`{ cpuLoad: number; memoryUsage: number }`** — Object containing CPU load and memory usage

  ```js
  const stats = node.getSystemStats();
  console.log(`CPU Load: ${stats.cpuLoad}%, Memory Usage: ${stats.memoryUsage} bytes`);
  ```
  ::
::
::

#### isOverloaded
::field{name="isOverloaded" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:alert-triangle'
  ---
  #title
  Is Overloaded

  #description
  Checks if the node is currently overloaded based on CPU and memory thresholds.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="cpuThreshold" type="number" defaultValue="80"}
    CPU usage percentage threshold
    ::

    ::field{name="memoryThreshold" type="number" defaultValue="80"}
    Memory usage percentage threshold
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`boolean`** — True if the node is overloaded, false otherwise

  ```js
  if (node.isOverloaded()) {
    console.log('Node is overloaded!');
  }
  ```
  ::
::
::

#### migrateAllPlayers
::field{name="migrateAllPlayers" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:git-branch'
  ---
  #title
  Migrate All Players

  #description
  Migrates all players from this node to another specified node or the best available node.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="targetNode" type="Node"}
    The target node to migrate players to. If not provided, the best available node will be chosen.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<void>`**

  ```js
  await node.migrateAllPlayers();
  ```
  ::
::
::

#### getNodeStatus
::field{name="getNodeStatus" type="method"}
::stack
  ::card
  ---
  icon: 'lucide:info'
  ---
  #title
  Get Node Status

  #description
  Retrieves a comprehensive status report for the node, including connection, performance, and player information.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="timeout" type="number" defaultValue="2000"}
    Timeout in milliseconds for the health check.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`object`** — An object containing the node's status, including `connected`, `version`, `stats` (cpu, memory, uptime), `players` (total, active, paused, idle), and `health` (status, needsRestart, responding, performance).

  ```js
  const status = await node.getNodeStatus();
  console.log(status);
  /*
  Example Output:
  {
    identifier: 'Node-1',
    connected: true,
    version: '1.4.0',
    stats: {
      cpu: 0.5,
      memory: 1024000000,
      uptime: 123456789
    },
    players: {
      total: 5,
      active: 3,
      paused: 2,
      idle: 0
    },
    health: {
      status: 'stable',
      needsRestart: false,
      responding: true,
      performance: 'excellent'
    }
  }
  */
  ```
  ::
::
::


## Performance Considerations

::alert{type="warning" icon="lucide:cpu"}
Consider these tips for optimal node performance:
::

1. **Load Balancing**: Distribute players across multiple nodes for better performance.
2. **Monitoring**: Regularly monitor node statistics to identify performance issues.
3. **Reconnection**: Properly configure reconnection parameters to handle temporary disconnections.
4. **Regions**: Associate nodes with specific regions to optimize voice latency.

::button-link{right-icon="lucide:arrow-right" to="/api/queue"}
  Continue to Queue
:: 