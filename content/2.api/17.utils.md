---
title: Utilities
description: A collection of helper functions and classes used internally by Moonlink.js, including the EventEmitter, HTTP request wrapper, and track encoding/decoding logic.
icon: lucide:wrench
---

While mostly used internally, these utilities can be helpful for advanced users building plugins or custom integrations.

## Classes

### EventEmitter
::api-card{name="class EventEmitter<E>"}
#description
A strongly-typed, priority-based Event Emitter implementation.

#default
::api-schema{name="on(event, listener, options)" type="Function"}
Adds a listener. Options can include `once` and `priority` (higher runs first). Returns a remove function.
::
::api-schema{name="once(event, listener, priority)" type="Function"}
Adds a one-time listener.
::
::api-schema{name="off(event, listener)" type="void"}
Removes a specific listener.
::
::api-schema{name="emit(event, ...args)" type="void"}
 Synchronously calls each of the listeners registered for the event.
::
::api-schema{name="createChild()" type="EventEmitter"}
Creates a child emitter that propagates events to the parent.
::

#example
```ts
const { EventEmitter } = require('moonlink.js');

class MyEmitter extends EventEmitter {}
const myEmitter = new MyEmitter();

myEmitter.on('test', (data) => console.log(data));
myEmitter.emit('test', 'Hello World');
```
::

### Structure
::api-card{name="abstract class Structure"}
#description
Manages the dependency injection and extension system for Moonlink.js classes.

#default
::api-schema{name="static get(name)" type="any"}
Retrieves a registered structure class.
::
::api-schema{name="static extend(name, extender)" type="void"}
Extends an existing structure with a new class.
::

#example
```ts
const { Structure } = require('moonlink.js');

// Extend the Player class
Structure.extend('Player', (BasePlayer) => class MyPlayer extends BasePlayer {
    constructor(...args) {
        super(...args);
        this.customProp = true;
    }
});
```
::

## Functions

### makeRequest(url, options)
::api-card{name="makeRequest(url, options)" returns="Promise<T | undefined>" anchorId="makerequest"}
#description
A robust HTTP/HTTPS request wrapper with built-in retry logic, timeout, and redirect handling. Used for all REST communications.

#default
::api-schema{name="url" type="string" required}
The URL to fetch.
::
::api-schema{name="options" type="object"}
Node.js `http.RequestOptions` plus optional `body`.
::

#example
```ts
const { makeRequest } = require('moonlink.js');

const data = await makeRequest('https://api.example.com/data', {
    method: 'GET',
    headers: { 'Authorization': '...' }
});
```
::

### decodeTrack(encoded)
::api-card{name="decodeTrack(encoded)" returns="ITrack" anchorId="decodetrack"}
#description
Decodes a Lavalink base64 track string into a usable object **without** making an API call. Useful for offline processing.

#default
::api-schema{name="encoded" type="string" required}
The base64 encoded string.
::

#example
```ts
const { decodeTrack } = require('moonlink.js');
const track = decodeTrack("QAA...");
console.log(track.info.title);
```
::

### encodeTrack(track)
::api-card{name="encodeTrack(track)" returns="string" anchorId="encodetrack"}
#description
Encodes a track info object into a Lavalink base64 string.

#default
::api-schema{name="track" type="ITrackInfo" required}
The track info object.
::

#example
```ts
const { encodeTrack } = require('moonlink.js');
const base64 = encodeTrack({
    title: "Never Gonna Give You Up",
    author: "Rick Astley",
    length: 212000,
    identifier: "dQw4w9WgXcQ",
    isSeekable: true,
    isStream: false,
    uri: "https://youtube.com/...",
    sourceName: "youtube",
    position: 0
});
```
::

### validate(prop, validator, error)
::api-card{name="validate(prop, validator, error)" returns="void" anchorId="validate"}
#description
Internal validation helper. Throws a `TypeError` with the `Moonlink.js >` prefix if validation fails.

#example
```ts
const { validate } = require('moonlink.js');

validate(volume, (v) => v >= 0 && v <= 100, "Volume must be between 0 and 100");
```
::

### delay(ms)
::api-card{name="delay(ms)" returns="Promise<void>" anchorId="delay"}
#description
Returns a promise that resolves after the specified milliseconds.

#example
```ts
const { delay } = require('moonlink.js');
await delay(5000);
```
::
