---
title: NodeManager
description: Manages all Lavalink node connections, including load balancing, automatic failover, and statistics monitoring.
icon: lucide:network
---

The `NodeManager` handles the lifecycle of your Lavalink nodes. It is responsible for connecting to nodes, tracking their health (CPU/Memory usage), and selecting the best node for new players based on load balancing strategies.

## Properties

::api-properties{name="NodeManager Properties" description="Core components and state accessible via the NodeManager instance."}
::api-section{title="References"}
::
::api-schema{name="manager" type="Manager" typeLink="/api/manager"}
The main Moonlink Manager instance that initialized this NodeManager.
::
::api-schema{name="nodes" type="Map<string, Node>"}
A Map containing all registered nodes, keyed by their identifier.
::

::api-section{title="State & Stats"}
::
::api-schema{name="onlineNodes" type="Node[]"}
Nodes with active WebSocket connections (may not be fully ready).
::
::api-schema{name="ready" type="Node[]"}
Nodes fully connected, authenticated, and ready for requests.
::
::api-schema{name="hasOnlineNodes" type="boolean"}
True if at least one node is connected.
::
::api-schema{name="hasReady" type="boolean"}
True if at least one node is ready for playback.
::
::api-schema{name="leastUsedNode" type="Node | undefined"}
The optimal node based on current load balancing.
::
::api-schema{name="stats" type="Record<string, any>"}
Aggregated statistics for all online nodes.
::
::

## Methods

### init()
::api-card{name="init()" method="init" returns="void" anchorId="init"}
#description
Initializes the NodeManager, adding all nodes from the configuration and initiating connections.
**Note:** This is called automatically by `manager.init()`.

#example
```ts
// Usually called internally
manager.nodes.init();
```
::

### add(config)
::api-card{name="add(config)" method="add" returns="void" anchorId="add"}
#description
Adds a new Lavalink node to the manager and attempts to connect immediately.

#default
::api-schema{name="config" type="IManagerNodeConfig" required}
The configuration object for the new node.
::

#example
```ts
manager.nodes.add({
    host: "backup.lavalink.org",
    port: 2333,
    password: "youshallnotpass",
    identifier: "Node-01" // We will use this ID in other examples
});
```
::

### remove(identifier)
::api-card{name="remove(identifier)" method="remove" returns="boolean" anchorId="remove"}
#description
Disconnects and removes a node from the manager. Returns `true` if successful.

#default
::api-schema{name="identifier" type="string" required}
The unique identifier of the node to remove.
::

#example
```ts
const success = manager.nodes.remove("Node-01");
if (success) console.log("Node-01 removed successfully.");
```
::

### findNode(options)
::api-card{name="findNode(options)" method="findNode" returns="Node | undefined" anchorId="findnode"}
#description
Finds the best available node based on the configured `selectionStrategy` (e.g., least load, lowest memory). It also respects health checks (CPU/Memory limits) if configured.

#default
::api-schema{name="options" type="object"}
Optional filters.
::

::api-section{title="options"}
::
::api-schema{name="exclude" type="string[]" nested}
Array of node identifiers to ignore during selection.
::

#example
```ts
// Find a node but exclude "Node-01" explicitly
const node = manager.nodes.findNode({
    exclude: ["Node-01"]
});
```
::

### eject(identifier)
::api-card{name="eject(identifier)" method="eject" returns="Promise<boolean>" anchorId="eject"}
#description
Gracefully removes a node. Unlike `remove()`, this method first attempts to **move all active players** from this node to another healthy node. If no other nodes are available, the players are destroyed.

#default
::api-schema{name="identifier" type="string" required}
The identifier of the node to eject.
::

#example
```ts
// Move players off "Node-01" and shut it down
await manager.nodes.eject("Node-01");
console.log("Node-01 ejected safely.");
```
::