---
title: Utils
description: "API reference for utilities in Moonlink.js"
icon: 'lucide:tool-case'
authors:
  - avatar: https://www.npmjs.com/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hNmE5NDVhYjJiNzk1MjcyNzVjN2IwMWEyNWM1YzQ2NT9zaXplPTQ5NiZkZWZhdWx0PXJldHJvIn0.5hP6oyShhR-UWUi6KF-lA0cWmE_BJjvIFAwkYCGEZNo
    name: Lucas Morais Rodrigues
    username: 1Lucas1apk
    to: https://github.com/1Lucas1apk
    target: _blank
---

<branch version="1.0.x">

::card{icon="lucide:tool"}
#title
Utility Functions and Classes

#description
Core utilities provided by Moonlink.js for extending and customizing functionality.
::

::alert{type="info" icon="lucide:info"}
All utilities are available through the main module and can be imported directly.
::

## Utility Functions

#### validateProperty
::field{name="validateProperty" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:check-circle'
  ---
  #title
  Validate Property

  #description
  Validates a property based on a validation function.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="property" type="any" required}
    The property to validate
    ::
    ::field{name="validator" type="Function" required}
    Function that returns a boolean indicating if property is valid
    ::
    ::field{name="errorMessage" type="string" required}
    Error message to throw if property is invalid
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`** - Throws error if property is invalid

```js
// Validate port number
validateProperty(
  options.port,
  value => value === undefined || (value >= 0 && value <= 65535),
  "Invalid port value. Must be between 0 and 65535."
);

// Validate string
validateProperty(
  options.identifier,
  value => value === undefined || typeof value === "string",
  "Invalid identifier. Must be a string."
);
```
  ::
::
::

#### delay
::field{name="delay" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:clock'
  ---
  #title
  Delay

  #description
  Creates a promise that resolves after specified milliseconds.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="ms" type="number" required}
    Milliseconds to delay
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<void>`**

```js
// Wait for 1 second
await delay(1000);

// Use in async function
async function reconnect() {
  console.log('Reconnecting in 5 seconds...');
  await delay(5000);
  console.log('Reconnecting now');
}
```
  ::
::
::

#### decodeTrack
::field{name="decodeTrack" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:file-code'
  ---
  #title
  Decode Track

  #description
  Decodes a base64-encoded track string.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="encodedTrack" type="string" required}
    Base64-encoded track string
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`ITrack`** - Decoded track object

```js
const track = decodeTrack('base64EncodedTrackString');
console.log(track.info.title);
console.log(track.info.author);
console.log(track.info.length);
```
  ::
::
::

#### encodeTrack
::field{name="encodeTrack" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:file-code'
  ---
  #title
  Encode Track

  #description
  Encodes track information into a base64 string.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="track" type="ITrackInfo" required}
    Track object to encode
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`string`** - Base64-encoded track string

```js
const encodedTrack = encodeTrack({
  title: 'Song Name',
  author: 'Artist',
  length: 180000,
  identifier: 'trackId',
  isStream: false,
  uri: 'https://example.com/track',
  sourceName: 'youtube'
});
```
  ::
::
::

#### generateUUID
::field{name="generateUUID" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:key'
  ---
  #title
  Generate UUID

  #description
  Generates a unique identifier (UUID) based on host and port using SHA256 hashing.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="host" type="string" required}
    Host name or IP address
    ::
    ::field{name="port" type="number" required}
    Port number
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`string`** - SHA256 hashed UUID

```js
const uuid = generateUUID('localhost', 2333);
console.log(uuid); // e.g., 'a6a945ab2b79527275c7b01a25c5c465'
```
  ::
::
::

#### compareVersions
::field{name="compareVersions" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:git-compare'
  ---
  #title
  Compare Versions

  #description
  Compares two version strings (e.g., "1.0.0", "1.2.3") and returns a number indicating their relative order.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="current" type="string" required}
    The current version string.
    ::
    ::field{name="required" type="string" required}
    The required version string.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`number`** - A negative number if `current` is less than `required`, a positive number if `current` is greater than `required`, or `0` if they are equal.

```js
const result1 = compareVersions("1.0.0", "1.0.0"); // 0
const result2 = compareVersions("1.0.0", "1.1.0"); // -1 (current is less than required)
const result3 = compareVersions("1.2.0", "1.1.0"); // 1 (current is greater than required)
```
  ::
::
::

#### stringifyWithReplacer
::field{name="stringifyWithReplacer" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:code-2'
  ---
  #title
  Stringify with Replacer

  #description
  Converts a JavaScript value to a JSON string, handling circular references by replacing them with `"[Circular Refs]"`.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="obj" type="any" required}
    The value to convert to a JSON string.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`string`** - A JSON string representation of the value.

```js
const obj = {};
obj.a = obj;
const jsonString = stringifyWithReplacer(obj);
console.log(jsonString); // {"a":"[Circular Refs]"}
```
  ::
::
::

#### Log
::field{name="Log" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:file-text'
  ---
  #title
  Log

  #description
  Logs a message to a specified file.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="message" type="string" required}
    Message to log
    ::
    ::field{name="LogPath" type="string" required}
    Path to log file
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`void`**

```js
Log('Player created', './logs/moonlink.log');
```
  ::
::
::

#### makeRequest
::field{name="makeRequest" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:send'
  ---
  #title
  Make Request

  #description
  Makes an HTTP request and returns JSON response. Now supports retries and timeouts.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="url" type="string" required}
    Request URL
    ::
    ::field{name="options" type="http.RequestOptions & { body?: any }" required}
    Request options, including optional body.
    ::
    ::field{name="timeout" type="number"}
    Optional: Request timeout in milliseconds. Defaults to 10000.
    ::
    ::field{name="retries" type="number"}
    Optional: Number of retry attempts. Defaults to 3.
    ::
    ::field{name="retryDelay" type="number"}
    Optional: Delay between retries in milliseconds. Defaults to 1000.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`Promise<T | undefined>`** - Generic type response or `undefined` if request fails after retries.

```js
// GET request with custom timeout and retries
const data = await makeRequest('https://api.example.com/data', {
  method: 'GET',
  headers: { 'Content-Type': 'application/json' }
}, 5000, 5);

// POST request
const response = await makeRequest('https://api.example.com/data', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ key: 'value' })
});
```
  ::
::
::

#### isSourceBlacklisted
::field{name="isSourceBlacklisted" type="function"}
::stack
  ::card
  ---
  icon: 'lucide:ban'
  ---
  #title
  Is Source Blacklisted

  #description
  Checks if a given source name is blacklisted in the Manager options.
  <br>
  <h5>Parameters</h5>

  ::field-group
    ::field{name="manager" type="Manager" required}
    The Manager instance.
    ::
    ::field{name="sourceName" type="string" required}
    The name of the source to check.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Returns & Example

  #description
  **Returns**
  • **`boolean`** - `true` if the source is blacklisted, `false` otherwise.

```js
const isBlacklisted = isSourceBlacklisted(manager, 'spotify');
if (isBlacklisted) {
  console.log('Spotify is blacklisted.');
}
```
  ::
::
::

## Utility Classes

#### Structure
::field{name="Structure" type="class"}
::stack
  ::card
  ---
  icon: 'lucide:box'
  ---
  #title
  Structure Class

  #description
  Abstract class for extending and customizing Moonlink.js structures. Provides static methods for managing the Manager instance and extending core classes.
  <br>
  <h5>Static Methods</h5>

  ::field-group
    ::field{name="setManager" type="method"}
    Sets the global Manager instance for internal use.
    ::
    ::field{name="getManager" type="method"}
    Retrieves the global Manager instance.
    ::
    ::field{name="extend" type="method"}
    Extends a core Moonlink.js structure (e.g., `Player`, `Node`) with custom functionality.
    ::
    ::field{name="get" type="method"}
    Retrieves an extended or default structure by name.
    ::
  ::
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Example Usage

  #description
```js
// Extend Player class
Structure.extend('Player', Player => {
  return class CustomPlayer extends Player {
    constructor(manager, options) {
      super(manager, options);
      this.customProperty = 'custom value';
    }
    
    customMethod() {
      return this.customProperty;
    }
  };
});

// Use custom player
const player = manager.players.create({
  guildId: '123456789',
  voiceChannelId: '123456789',
  textChannelId: '123456789'
});

console.log(player.customProperty);
player.customMethod();
```
  ::
::
::

#### Plugin
::field{name="Plugin" type="class"}
::stack
  ::card
  ---
  icon: 'lucide:puzzle'
  ---
  #title
  Plugin Class

  #description
  Base class for creating Moonlink.js plugins. Plugins can extend core functionalities and integrate with the Manager.
  <br>
  <h5>Properties</h5>

  | Property | Type | Description |
  | -------- | ---- | ----------- |
  | `name` | `string` | The name of the plugin. |
  | `version` | `string` | The version of the plugin. |
  | `description` | `string` | A brief description of the plugin's purpose. |
  | `author` | `string | Record<string, any>` | The author(s) of the plugin. Can be a string or an object. |
  | `minVersion` | `string` | The minimum Moonlink.js version required by this plugin. |

  <h5>Methods</h5>

  | Method | Description |
  | ------ | ----------- |
  | `load(manager)` | Called when the plugin is loaded by the Manager. |
  | `unload(manager)` | Called when the plugin is unloaded from the Manager. |
  ::

  ::card
  ---
  icon: 'lucide:fold-horizontal'
  icon-size: 26
  horizontal: true
  ---
  #title
  Example Usage

  #description
```js
class CustomPlugin extends Plugin {
  constructor() {
    super();
    this.name = 'CustomPlugin';
    this.version = '1.0.0';
    this.description = 'A custom plugin';
    this.author = 'Your Name';
    this.minVersion = '1.0.0'; // Specify minimum Moonlink.js version
  }
  
  load(manager) {
    console.log(`${this.name} loaded`);
    
    // Add custom functionality
    Structure.extend('Player', Player => {
      return class CustomPlayer extends Player {
        constructor(manager, options) {
          super(manager, options);
          this.pluginProperty = 'plugin value';
        }
      };
    });
  }
  
  unload(manager) {
    console.log(`${this.name} unloaded`);
  }
}

// Register plugin
manager.plugins.register(new CustomPlugin());
```
  ::
::
::

## Utils

::button-link{right-icon="lucide:arrow-right" to="/api/search-result"}
  Continue to SearchResult
:: 